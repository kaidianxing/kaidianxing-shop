(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[63],{1348:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-content-bar",{scopedSlots:e._u([{key:"btn",fn:function(){return[a("Button",{staticClass:"primary-long",on:{click:e.handleSave}},[e._v("保存")]),a("Button",{staticClass:"default-long",on:{click:e.getBack}},[e._v("返回列表")])]},proxy:!0}])},[a("div",{staticClass:"order-ordinary-express-add"},[a("Form",{ref:"form",attrs:{model:e.model,rules:e.rules,"label-width":120}},[a("div",{staticClass:"order-ordinary-express-add-content"},[a("kdx-form-title",[e._v(e._s(e.title))]),a("FormItem",{attrs:{label:"排序：",prop:"sort"}},[a("Input",{staticClass:"width-160",attrs:{maxlength:"4",placeholder:"请输入"},model:{value:e.model.sort,callback:function(t){e.$set(e.model,"sort",t)},expression:"model.sort"}}),a("kdx-hint-text",[e._v("最多4位数字，数字越大，排名越靠前，默认排序为创建时间")])],1),a("FormItem",{attrs:{label:"名称：",prop:"dispatch_name"}},[a("Input",{staticClass:"width-430",attrs:{rows:1,autosize:"",maxlength:"20","show-word-limit":"",placeholder:"请输入"},model:{value:e.model.dispatch_name,callback:function(t){e.$set(e.model,"dispatch_name",t)},expression:"model.dispatch_name"}})],1),a("FormItem",{attrs:{label:"快递公司："}},[a("select-express",{staticClass:"width-430",attrs:{value:e.model.express,"option-data":e.optionData.express},on:{"update:value":function(t){return e.$set(e.model,"express",t)}}}),a("kdx-hint-text",[e._v("您如果选择了常用快递，则客户可以在订单中查询快递信息，如果缺少您想要的快递，您可以联系我们！")])],1),a("FormItem",{attrs:{label:"计费方式："}},[a("RadioGroup",{on:{"on-change":e.changeRecharge},model:{value:e.model.calculate_type,callback:function(t){e.$set(e.model,"calculate_type",t)},expression:"model.calculate_type"}},[a("Radio",{attrs:{label:1}},[a("span",[e._v("按件计费")])]),a("Radio",{attrs:{label:0}},[a("span",[e._v("按重量计费")])])],1),a("kdx-hint-alert",{directives:[{name:"show",rawName:"v-show",value:"1"===e.model.calculate_type,expression:"model.calculate_type === '1'"}]},[e._v(" 根据件数来计算运费，当物品不足《首件数量》时，按照《首件费用》计算，超过部分按照《续件重量》和《续件费用》乘积来计算 ")]),a("kdx-hint-alert",{directives:[{name:"show",rawName:"v-show",value:"0"===e.model.calculate_type,expression:"model.calculate_type === '0'"}]},[e._v(" 根据重量来计算运费，当物品不足《首重重量》时，按照《首重费用》计算，超过部分按照《续重重量》和《续重费用》乘积来计算 ")]),a("div",{staticClass:"form-item-bg-box"},[a("charge-mode-list",{ref:"charge_mode",attrs:{type:e.model.calculate_type,"limit-arr":e.region.limitArr},on:{"on-edit":function(t){return e.showRegionModal("recharge-edit",t)}}}),a("div",{staticClass:"area-big-btn"},[a("Button",{attrs:{type:"text"},on:{click:function(t){return e.showRegionModal("recharge-add")}}},[e._v("+添加配送区域")])],1)],1)],1)],1),a("div",{staticClass:"order-ordinary-express-add-content"},[a("kdx-form-title",[e._v("特殊区域设置")]),a("FormItem",{attrs:{label:"类型："}},[a("RadioGroup",{on:{"on-change":e.changeSpecial},model:{value:e.model.dispatch_area_type,callback:function(t){e.$set(e.model,"dispatch_area_type",t)},expression:"model.dispatch_area_type"}},[a("Radio",{attrs:{label:0}},[a("span",[e._v("不配送区域")])]),a("Radio",{attrs:{label:1}},[a("span",[e._v("只配送区域")])])],1),a("div",{staticClass:"form-item-bg-box"},[e.special_region.text?a("div",{staticClass:"area"},[a("div",{staticClass:"area-content"},[e._v(" "+e._s(e.special_region.text)+" ")]),a("div",{staticClass:"area-btn"},[a("Button",{attrs:{type:"text"},on:{click:function(t){return e.showRegionModal("special",e.special_region)}}},[e._v(" 编辑 ")]),a("Button",{attrs:{type:"text"},on:{click:e.deleteSpecialRegion}},[e._v("删除")])],1)]):a("div",{staticClass:"area-big-btn"},[a("Button",{directives:[{name:"show",rawName:"v-show",value:"0"==e.model.dispatch_area_type,expression:"model.dispatch_area_type == '0'"}],attrs:{type:"text"},on:{click:function(t){return e.showRegionModal("special")}}},[e._v("+添加不配送区域 ")]),a("Button",{directives:[{name:"show",rawName:"v-show",value:"1"==e.model.dispatch_area_type,expression:"model.dispatch_area_type == '1'"}],attrs:{type:"text"},on:{click:function(t){return e.showRegionModal("special")}}},[e._v("+添加只配送区域 ")])],1)])],1)],1),a("div",{staticClass:"order-ordinary-express-add-content"},[a("kdx-form-title",[e._v("使用状态")]),a("FormItem",{attrs:{label:"设为默认："}},[a("RadioGroup",{model:{value:e.model.is_default,callback:function(t){e.$set(e.model,"is_default",t)},expression:"model.is_default"}},[a("Radio",{attrs:{label:1}},[e._v("是")]),a("Radio",{attrs:{label:0}},[e._v("否")])],1)],1),a("FormItem",{attrs:{label:"是否启用："}},[a("RadioGroup",{model:{value:e.model.state,callback:function(t){e.$set(e.model,"state",t)},expression:"model.state"}},[a("Radio",{attrs:{label:1}},[e._v("是")]),a("Radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1)])],1),a("selector-region",{attrs:{visible:e.region.modal,list:e.region.data,"limit-list":e.region.limitArr},on:{"on-ok":e.regionSelectOk,"on-cancel":e.regionSelectCancel}})],1)},r=[]},2206:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"select-express"},[a("Select",{attrs:{filterable:""},on:{"on-change":e.handleChange},model:{value:e.express,callback:function(t){e.express=t},expression:"express"}},e._l(e.optionData,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name)+" ")])})),1),a("div",{staticClass:"express-tag"},e._l(e.common,(function(t){return a("span",{key:t.id,class:{checked:t.id===e.express},on:{click:function(a){return e.handleChange(t.id)}}},[e._v(" "+e._s(t.name)+" ")])})),0)],1)},r=[]},"392e":function(e,t,a){"use strict";a.r(t);var i=a("2206"),r=a("df89");for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);a("9ad5");var s=a("2877"),o=Object(s["a"])(r["default"],i["a"],i["b"],!1,null,"83c54aaa",null);t["default"]=o.exports},"3a8c":function(e,t,a){"use strict";a.r(t);var i=a("866b"),r=a("ebbe");for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);a("fdd3");var s=a("2877"),o=Object(s["a"])(r["default"],i["a"],i["b"],!1,null,"8219f5d2",null);t["default"]=o.exports},"4b56":function(e,t,a){},6402:function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a("5530")),n=i(a("15fd"));a("e9c4"),a("d3b7"),a("159b");var s=i(a("392e")),o=i(a("3a8c")),l=i(a("0a52")),d=["error","dispatch_area"],c={name:"index",components:{SelectExpress:s.default,ChargeModeList:o.default,SelectorRegion:l.default},data:function(){return{model:{sort:"",dispatch_name:"",express:"",calculate_type:1,dispatch_area_type:0,is_default:0,state:1},rules:{sort:[{pattern:/^(0|[1-9][0-9]*)$/,message:"排序为数字类型，最长为4位数"}],dispatch_name:[{required:!0,message:"配送方式名称必填"}]},title:"",optionData:{express:[]},region:{data:{},modal:!1,type:"",limitArr:[]},deliveryArea:{},deliveryNoArea:{},special_region:{},numArea:{},weightArea:{},regionIndex:-1}},methods:{regionSelectOk:function(e){"special"===this.region.type?(this.special_region=e,"0"==this.model.dispatch_area_type?this.deliveryNoArea=e:"1"==this.model.dispatch_area_type&&(this.deliveryArea=e),this.model.dispatch_limit_area=e):"recharge-edit"===this.region.type?this.$refs["charge_mode"].initData({data:e,type:"2"}):"recharge-add"===this.region.type&&this.$refs["charge_mode"].initData({data:e,type:"1"}),this.regionSelectCancel()},regionSelectCancel:function(){this.region.modal=!1},showRegionModal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.region.type=e,this.region.data=t||{},this.region.limitArr="special"===e?[]:this.$refs["charge_mode"].getAreaCode(),this.region.modal=!0},deleteSpecialRegion:function(){this.special_region={}},changeRecharge:function(){var e=this;"1"==this.model.calculate_type?(this.weightArea=JSON.parse(JSON.stringify(this.$refs["charge_mode"].table.data))||{},this.$nextTick((function(){e.$refs["charge_mode"].initData({type:"0",data:e.numArea})}))):"0"==this.model.calculate_type&&(this.numArea=JSON.parse(JSON.stringify(this.$refs["charge_mode"].table.data))||{},this.$nextTick((function(){e.$refs["charge_mode"].initData({type:"0",data:e.weightArea})})))},changeSpecial:function(){"0"==this.model.dispatch_area_type?(this.deliveryArea=JSON.parse(JSON.stringify(this.special_region)),this.special_region=JSON.parse(JSON.stringify(this.deliveryNoArea))||{}):"1"==this.model.dispatch_area_type&&(this.deliveryNoArea=JSON.parse(JSON.stringify(this.special_region)),this.special_region=JSON.parse(JSON.stringify(this.deliveryArea))||{})},init:function(){this.id=this.$route.query.id||0;var e=this.$route.params.id;"edit"===e?(this.getData(),this.title="修改配送方式"):"add"===e&&(this.title="新增配送方式"),this.getExpressList()},getData:function(){var e=this;this.resetModel(),this.$api.orderApi.getExpressStyle({id:this.id}).then((function(t){var a=t.error,i=t.dispatch_area,s=(0,n.default)(t,d);if(0===a){e.model=s;var o=[s.default];i?(i=JSON.parse(i),i.forEach((function(e){var t=(0,r.default)((0,r.default)({},e),{},{region_area:{text:e.city,areas:e.citys_code}});delete t.city,delete t.citys_code,o.push(t)}))):i="",e.special_region.text=s.dispatch_limit_area||"",e.special_region.areas=s.dispatch_limit_area_code&&JSON.parse(s.dispatch_limit_area_code),delete e.model.default,e.$nextTick((function(){e.$refs["charge_mode"].initData({type:"0",data:o})}))}}))},getExpressList:function(){var e=this;this.$api.settingApi.getExpressList().then((function(t){0===t.error&&(e.optionData.express=t.list)}))},getBack:function(){this.$router.go(-1)},handleSave:function(){var e=this;this.$refs["form"].validate((function(t){if(t&&!e.$refs["charge_mode"].validate()){var a=Object.assign({},e.model);a.dispatch_limit_area=e.special_region.text||"",a.dispatch_limit_area_code=e.special_region.areas?JSON.stringify(e.special_region.areas):"";var i=e.$refs["charge_mode"].getModel();Object.assign(a,i),"edit"===e.$route.params.id?e.editExpressStyle(a):"add"===e.$route.params.id&&e.addExpressStyle(a)}}))},addExpressStyle:function(e){var t=this;this.$api.orderApi.addExpressStyle(e).then((function(e){0===e.error&&(t.$Message.success("配送方式新增成功"),t.$router.go(-1))}))},editExpressStyle:function(e){var t=this;this.$api.orderApi.editExpressStyle(e).then((function(e){0===e.error&&(t.$Message.success("配送方式修改成功"),t.$router.go(-1))}))},resetModel:function(){this.model={sort:"",dispatch_name:"",express:"",calculate_type:1,dispatch_area_type:0,is_default:0,state:1}}},mounted:function(){this.init()}};t.default=c},"6c70":function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(a("b85c"));a("a9e3"),a("b680"),a("a434"),a("b64b"),a("d3b7"),a("159b"),a("e9c4"),a("99af");var n={name:"chargeModeList",props:{type:{type:[String,Number],default:1}},data:function(){var e=this;this.$createElement;return{columns:[],table:{data:[]},pieceColumns:[{title:"配送范围",key:"way",minWidth:200,render:function(t,a){return 0===a.index?t("div",{class:"national-unity"},["全国统一运费"]):t("div",{class:"other-area"},[t("div",{class:"area"},[a.row.region_area.text]),t("div",{class:"area-btn"},[t("Button",{attrs:{type:"text"},on:{click:function(){e.editRegion(a.index,a.row.region_area)}}},["编辑"]),t("Button",{attrs:{type:"text"},on:{click:function(){e.deleteRegion(a.index,a.row)}}},["删除"])])])}},{title:"首件(个)",key:"start_num",render:function(t,a){return t("kdx-rr-input",{attrs:{type:"text",number:!0,maxValue:999999999,fixed:0,value:a.row[a.column.key]},on:{"on-blur":function(t){e.changeData(a.index,a.column.key,t.target.value,"int")}}})}},{title:"运费(元)",key:"start_num_price",render:function(t,a){return t("kdx-rr-input",{attrs:{type:"text",number:!0,maxValue:9999999.99,fixed:2,value:a.row[a.column.key]},on:{"on-blur":function(t){e.changeData(a.index,a.column.key,t.target.value,"float")}}})}},{title:"续件(个)",key:"add_num",render:function(t,a){return t("kdx-rr-input",{attrs:{type:"text",number:!0,maxValue:999999999,fixed:0,value:a.row[a.column.key]},on:{"on-blur":function(t){e.changeData(a.index,a.column.key,t.target.value,"int")}}})}},{title:"运费(元)",key:"add_num_price",render:function(t,a){return t("kdx-rr-input",{attrs:{type:"text",number:!0,maxValue:9999999.99,fixed:2,value:a.row[a.column.key]},on:{"on-blur":function(t){e.changeData(a.index,a.column.key,t.target.value,"float")}}})}}],weightColumns:[{title:"配送范围",key:"way",minWidth:200,render:function(t,a){return 0===a.index?t("div",{class:"national-unity"},["全国统一运费"]):t("div",{class:"other-area"},[t("div",{class:"area"},[a.row.region_area.text]),t("div",{class:"area-btn"},[t("Button",{attrs:{type:"text"},on:{click:function(){e.editRegion(a.index,a.row.region_area[0])}}},["编辑"]),t("Button",{attrs:{type:"text"},on:{click:function(){e.deleteRegion(a.index)}}},["删除"])])])}},{title:"首重(克)",key:"start_weight",render:function(t,a){return t("kdx-rr-input",{attrs:{type:"text",number:!0,maxValue:9999999.99,fixed:2,value:a.row[a.column.key]},on:{"on-blur":function(t){e.changeData(a.index,a.column.key,t.target.value,"float")}}})}},{title:"运费(元)",key:"start_weight_price",render:function(t,a){return t("kdx-rr-input",{attrs:{type:"text",number:!0,maxValue:9999999.99,fixed:2,value:a.row[a.column.key]},on:{"on-blur":function(t){e.changeData(a.index,a.column.key,t.target.value,"float")}}})}},{title:"续重(克)",key:"add_weight",render:function(t,a){return t("kdx-rr-input",{attrs:{type:"text",number:!0,maxValue:9999999.99,fixed:2,value:a.row[a.column.key]},on:{"on-blur":function(t){e.changeData(a.index,a.column.key,t.target.value,"float")}}})}},{title:"运费(元)",key:"add_weight_price",render:function(t,a){return t("kdx-rr-input",{attrs:{type:"text",number:!0,maxValue:9999999.99,fixed:2,value:a.row[a.column.key]},on:{"on-blur":function(t){e.changeData(a.index,a.column.key,t.target.value,"float")}}})}}],priceItem:{start_num:"",start_num_price:"",add_num:"",add_num_price:"",region_area:{}},weightItem:{start_weight:"",start_weight_price:"",add_weight:"",add_weight_price:"",region_area:{}},index:0}},watch:{type:{handler:function(){this.init()},immediate:!0}},methods:{changeData:function(e,t,a,i){var r;"int"===i?r=Math.abs(parseInt(a))||"0":"float"===i&&(r=parseFloat(a)?Math.abs(parseFloat(a).toFixed(2)):"0.00"),this.$set(this.table.data[e],t,r)},init:function(){var e={};1===this.type?(this.columns=this.pieceColumns,Object.assign(e,this.priceItem)):0===this.type&&(this.columns=this.weightColumns,Object.assign(e,this.weightItem)),this.table.data=[e]},initData:function(e){var t=e.type,a=e.data;if("0"==t)null!==a&&void 0!==a&&a.length?this.table.data=a:this.init();else if("1"==t){var i={};1==this.type?i=Object.assign({},this.priceItem):0==this.type&&(i=Object.assign({},this.weightItem)),i.region_area=a,this.table.data.push(i)}else"2"==t&&this.$set(this.table.data[this.index],"region_area",a)},editRegion:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.index=e,this.$emit("on-edit",t)},deleteRegion:function(e){this.table.data.splice(e,1)},validate:function(){var e=!1,t="";t=1==this.type?"start_num,add_num":"start_weight,add_weight";var a,i=(0,r.default)(this.table.data);try{for(i.s();!(a=i.n()).done;){for(var n=a.value,s=Object.keys(n),o=0,l=s;o<l.length;o++){var d=l[o];if(!n[d]){e=!0,this.$Message.error("计费信息不可为空");break}if(t.indexOf(d)>-1&&"0"==parseFloat(n[d])){e=!0,1===this.type?this.$Message.error("首件和续件不可为0"):this.$Message.error("首重和续重不可为0");break}}if(e)break}}catch(c){i.e(c)}finally{i.f()}return e},getModel:function(){var e={},t=this.table.data[0];if(delete t.region_area,Object.assign(e,t),this.table.data.length>1){var a=[];this.table.data.forEach((function(e,t){if(t>0){var i=e;i.city=e.region_area.text,i.citys_code=e.region_area.areas,delete i.region_area,a.push(i)}})),0===a.length&&(a=""),Object.assign(e,{dispatch_area:JSON.stringify(a)})}else e.dispatch_area="";return e},getAreaCode:function(){if(this.table.data.length>1){var e=[];return this.table.data.forEach((function(t,a){a>0&&(e=e.concat(t.region_area.areas||[]))})),e}return[]}},mounted:function(){this.init()}};t.default=n},"866b":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"order-ordinary-express-charge-mode-list"},[a("Table",{ref:"table",attrs:{columns:e.columns,data:e.table.data}})],1)},r=[]},"90e30":function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("a9e3");var i={name:"SelectExpress",props:{value:{type:[String,Number],required:!0},optionData:{type:Array,default:function(){return[]},required:!0}},data:function(){return{express:"",common:[{id:"1",name:"顺丰"},{id:"2",name:"申通"},{id:"3",name:"韵达"},{id:"5",name:"圆通"},{id:"6",name:"中通"}]}},watch:{value:{handler:function(){this.express=this.value},immediate:!0}},methods:{handleChange:function(e){e!==this.express&&(this.express=e),this.$emit("update:value",e)}}};t.default=i},9229:function(e,t,a){},9484:function(e,t,a){"use strict";a("4b56")},"9ad5":function(e,t,a){"use strict";a("9229")},a291:function(e,t,a){},cf38:function(e,t,a){"use strict";a.r(t);var i=a("1348"),r=a("f7e4");for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);a("9484");var s=a("2877"),o=Object(s["a"])(r["default"],i["a"],i["b"],!1,null,"ca6d9e6c",null);t["default"]=o.exports},df89:function(e,t,a){"use strict";a.r(t);var i=a("90e30"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=r.a},ebbe:function(e,t,a){"use strict";a.r(t);var i=a("6c70"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=r.a},f7e4:function(e,t,a){"use strict";a.r(t);var i=a("6402"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=r.a},fdd3:function(e,t,a){"use strict";a("a291")}}]);