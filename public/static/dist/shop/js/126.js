(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[126],{"0022":function(e,t,n){"use strict";n.r(t);var a=n("2fd2"),i=n.n(a);for(var s in a)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(s);t["default"]=i.a},"005c":function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.staticRenderFns=t.render=void 0,n("ac1f"),n("841c"),n("b0c0");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vip-grade"},[t("kdx-header-bar",{attrs:{type:"little"},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"flex space-between"},[t("Button",{attrs:{type:"primary",disabled:e.noManagePerm},on:{click:e.toAddGrade}},[e._v("+添加会员等级")]),t("div",{staticClass:"flex"},[t("Form",{ref:"form",attrs:{model:e.search,"label-width":100,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[t("FormItem",{attrs:{label:"等级名称："}},[t("Input",{staticClass:"width-160",attrs:{type:"text",placeholder:"关键词查询"},on:{"on-enter":e.handleSearch},model:{value:e.search.keyword,callback:function(t){e.$set(e.search,"keyword",t)},expression:"search.keyword"}})],1),t("FormItem",{attrs:{label:"等级状态："}},[t("Select",{staticClass:"width-160",attrs:{value:e.search.state},on:{"on-change":e.handleChange}},e._l(e.grade,(function(n){return t("Option",{key:n.value,attrs:{value:n.value}},[e._v(" "+e._s(n.name)+" ")])})),1)],1)],1),t("div",{staticClass:"btn"},[t("Button",{staticClass:"mL-20",attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),t("Button",{staticClass:"mL-20",attrs:{type:"text"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)]},proxy:!0}])}),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-list"},[t("table-list",{ref:"tableList",attrs:{data:e.list,total:e.total},on:{getList:e.getList,"on-page-change":e.changePage}})],1),e._t("default")],2)};t.render=a;var i=[];t.staticRenderFns=i},"05fd":function(e,t,n){},"1a8b":function(e,t,n){"use strict";n.r(t);var a=n("f1bf"),i=n("0022");for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("483e");var r=n("2877"),o=Object(r["a"])(i["default"],a["render"],a["staticRenderFns"],!1,null,"36fef32e",null);t["default"]=o.exports},"243f":function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("a9e3"),n("14d9"),n("d81d");var a={name:"TableList",props:{data:{type:Array,default:function(){return[]}},total:{type:[String,Number],default:0}},data:function(){var e=this;this.$createElement;return{columns:[{type:"selection",width:40,align:"center"},{title:"等级",key:"level",render:function(e,t){return"1"==t.row.is_default?e("div",["默认"]):e("div",[t.row.level])}},{title:"等级名称",key:"level_name"},{title:"升级条件",key:"update_text"},{title:"可享折扣权益",key:"discount",render:function(e,t){return e("div",[0==t.row.is_discount?"无":Number(t.row.discount)+"折"])}},{title:"会员数量",key:"member_count"},{title:"状态",key:"state",render:function(e,t){return e("div",[1==t.row.state?e("span",{class:"success-color"},["已启用"]):e("span",{class:"danger-color"},["未启用"])])}},{title:"操作",key:"action",width:200,render:function(t,n){return"1"==n.row.is_default?t("div",{class:"action"},[t("Button",{attrs:{type:"text"},on:{click:function(){e.lookVipStatistics(n.row)}}},["会员统计"]),t("Button",{attrs:{type:"text",disabled:e.noManagePerm},on:{click:function(){e.$router.push({path:"/member/grade/edit",query:{id:n.row.id}})}}},["编辑"])]):(a=0==n.row.state?t("Button",{attrs:{type:"text",disabled:e.noManagePerm},on:{click:function(){e.handleUsing(n.row)}}},["启用"]):t("Button",{attrs:{type:"text",disabled:e.noManagePerm},on:{click:function(){e.handleUsing(n.row)}}},["禁用"]),t("div",{class:"action"},[a,t("Button",{attrs:{type:"text"},on:{click:function(){e.lookVipStatistics(n.row)}}},["会员统计"]),t("Button",{attrs:{type:"text",disabled:e.noManagePerm},on:{click:function(){e.$router.push({path:"/member/grade/edit",query:{id:n.row.id}})}}},["编辑"]),t("Button",{attrs:{type:"text",disabled:e.noManagePerm},on:{click:function(){e.handleDelete(n.row.id)}}},["删除"])]));var a}}],selectRows:[],isSelectAll:!1}},computed:{getTableData:function(){var e=this;return this.data.map((function(t){return t._disabled=e.noManagePerm,t}))},noManagePerm:function(){return!this.$getPermMap("member.level.manage")},isDisabled:function(){return 0===this.selectRows.length}},methods:{reset:function(e){this.$refs.page.reset(e)},selectChange:function(e){this.selectRows=e,this.isSelectAll=this.selectRows.length===this.data.length},checkboxChange:function(e){this.$refs["table"].selectAll(e)},handleUsing:function(e){var t=this,n=0;n=1==e.state?0:1,this.$api.memberApi.setLevelState({state:n,id:e.id}).then((function(e){0==e.error&&(t.$Message.success("修改成功"),t.$emit("getList"))}))},handleDelete:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"确认删除？",onOk:function(){t.$api.memberApi.deleteLevel({id:e}).then((function(e){0==e.error&&(t.$Message.success("删除成功"),t.$emit("getList"))}))},onCancel:function(){}})},lookVipStatistics:function(e){this.$router.push({path:"/member/list",query:{level_id:e.id}})},changePage:function(e){this.$emit("on-page-change",e),this.initFooterData()},initFooterData:function(){this.isSelectAll=!1,this.selectRows=[]},handleBatchDelete:function(){var e=this;this.$Modal.confirm({title:"提示",content:"确认批量删除？",onOk:function(){var t=e.selectRows.map((function(e){return e.id}));e.$api.memberApi.deleteLevel({id:t}).then((function(t){0==t.error&&(e.$Message.success("删除成功"),e.$emit("getList"))}))},onCancel:function(){}})}}};t.default=a},"2fd2":function(e,t,n){var a=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("5530"));n("ac1f"),n("841c"),n("14d9");var s=a(n("cb77")),r={name:"index",inject:["returnToTop"],components:{TableList:s.default},data:function(){return{search:{state:"all",keyword:""},grade:[{value:"all",name:"全部"},{value:"1",name:"启用"},{value:"0",name:"禁用"}],list:[],total:0,page:{pageSize:10,pageNumber:1},loading:!1}},computed:{noManagePerm:function(){return!this.$getPermMap("member.level.manage")}},created:function(){},mounted:function(){var e=this;this.$history.setRoute(this.$route).getData((function(t){e.$nextTick((function(){e.search=t.search||{state:"all",keyword:""},e.page=e.$utils.deepCopy(t.page)||{pageSize:10,pageNumber:1},e.$refs.tableList.reset(e.page),e.getList()}))}))},methods:{handleChange:function(e){this.search.state=e},toAddGrade:function(){this.$router.push({path:"/member/grade/add"})},getList:function(){var e=this;this.returnToTop(),this.loading=!0;var t=(0,i.default)((0,i.default)({},this.search),{},{state:"all"==this.search.state?"":this.search.state,pagesize:this.page.pageSize,page:this.page.pageNumber});this.$history.setData({search:this.$utils.deepCopy(this.search),page:this.page}),this.$api.memberApi.getLevelList(t).then((function(t){e.loading=!1,0==t.error&&(e.list=t.list,e.total=t.total)}))},addLabelGrade:function(){},handleSearch:function(){this.getList()},handleReset:function(){this.search={state:"",keyword:""},this.getList()},changePage:function(e){this.page=e,this.getList()}}};t.default=r},"483e":function(e,t,n){"use strict";n("05fd")},"59cd":function(e,t,n){"use strict";var a=n("b0ea");n.o(a,"render")&&n.d(t,"render",(function(){return a["render"]})),n.o(a,"staticRenderFns")&&n.d(t,"staticRenderFns",(function(){return a["staticRenderFns"]}))},"9f82a":function(e,t,n){},a775:function(e,t,n){"use strict";n("9f82a")},b0ea:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.staticRenderFns=t.render=void 0;var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"good-group-table-list"},[t("Table",{ref:"table",attrs:{columns:e.columns,data:e.getTableData},on:{"on-selection-change":e.selectChange}}),t("div",{staticClass:"footer-action"},[t("Checkbox",{attrs:{disabled:e.noManagePerm},on:{"on-change":e.checkboxChange},model:{value:e.isSelectAll,callback:function(t){e.isSelectAll=t},expression:"isSelectAll"}}),t("Button",{attrs:{disabled:e.isDisabled||e.noManagePerm},on:{click:e.handleBatchDelete}},[e._v("删除")])],1),t("div",{staticClass:"footer-page"},[t("kdx-page-component",{ref:"page",attrs:{total:e.total},on:{"on-change":e.changePage}})],1)],1)};t.render=n;var a=[];t.staticRenderFns=a},b5aa:function(e,t,n){"use strict";n.r(t);var a=n("243f"),i=n.n(a);for(var s in a)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(s);t["default"]=i.a},cb77:function(e,t,n){"use strict";n.r(t);var a=n("59cd"),i=n("b5aa");for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("a775");var r=n("2877"),o=Object(r["a"])(i["default"],a["render"],a["staticRenderFns"],!1,null,"730bce81",null);t["default"]=o.exports},f1bf:function(e,t,n){"use strict";var a=n("005c");n.o(a,"render")&&n.d(t,"render",(function(){return a["render"]})),n.o(a,"staticRenderFns")&&n.d(t,"staticRenderFns",(function(){return a["staticRenderFns"]}))}}]);